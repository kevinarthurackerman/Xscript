"use strict";$.ajaxPrefilter(function(e,t,a){if("POST"===e.type.toUpperCase()){var i=$("input[name^=__RequestVerificationToken]").first();if(!i.length)return;var r=i.attr("name");0===e.contentType.indexOf("application/json")?e.url+=(-1===e.url.indexOf("?")?"?":"&")+i.serialize():"string"==typeof e.data&&-1===e.data.indexOf(r)&&(e.data+=(e.data?"&":"")+i.serialize())}}),$.fn.validateData=function(){if($.validator&&$.validator.unobtrusive){var e=$(this),t=$();e.each(function(a,i){var r=$("<div>");e.eq(a).before(r),t=t.add(r)});var a=$("<form>");a.appendTo($(document.body)),a.append(e),a.removeData("validator").removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(a),a.validate();for(var i=a.valid(),r=0;r<e.length;r++)t.eq(r).before(e.eq(r)),t.eq(r).remove();return a.remove(),i}};var xscript={_:{_busy:!1}};$(window).on("beforeunload",function(){$.LoadingOverlay("show")}),$(window).on("popstate",function(){window.location.reload()}),$(document).ready(function(){xscript.refreshContent($("body"))}),xscript.defaults={url:".",dataSelector:null,position:"replace",blockUi:!0,blockUiDelay:5e3,requestTimeout:0,retryTimeout:100,processResult:!0,animations:{positionBody:{before:function(e){return e.animate({opacity:0,speed:"fast"}),e.promise()},after:function(e){return e.animate({opacity:1,queue:!1,speed:"fast"}),e.promise()}},positionBefore:{before:function(e,t){return t.hide().css("opacity",0),Promise.resolve()},after:function(e,t){return t.slideDown().animate({opacity:1,queue:!1,speed:"fast"}),t.promise()}},positionPrepend:{before:function(e,t){return t.hide().css("opacity",0),Promise.resolve()},after:function(e,t){return t.slideDown().animate({opacity:1,queue:!1,speed:"fast"}),t.promise()}},positionAppend:{before:function(e,t){return t.hide().css("opacity",0),Promise.resolve()},after:function(e,t){return t.slideDown().animate({opacity:1,queue:!1,speed:"fast"}),t.promise()}},positionAfter:{before:function(e,t){return t.hide().css("opacity",0),Promise.resolve()},after:function(e,t){return t.slideDown().animate({opacity:1,queue:!1,speed:"fast"}),t.promise()}},positionReplace:{before:function(e,t){return t.hide().css("opacity",0),e.animate({opacity:0,queue:!1,speed:"fast"}),e.promise()},after:function(e,t){return t.slideDown().animate({opacity:1,queue:!1,speed:"fast"}),t.promise()}},positionInsert:{before:function(e,t){return e.animate({opacity:0,speed:"fast"}),e.promise()},after:function(e,t){return e.animate({opacity:1,queue:!1,speed:"fast"}),e.promise()}},positionRemove:{before:function(e,t){return e.animate({opacity:0,queue:!1,speed:"fast"}),e.promise()},after:function(e,t){return Promise.resolve()}}}},xscript.execute=async function(e){for(var t=$.extend(!0,{},xscript.defaults,e);xscript._._busy;)await timeoutfunc(t.retryTimeout);if(!xscript._._busy){var a,i;if(t.blockUi&&window.setTimeout(function(){xscript._._busy&&$.LoadingOverlay("show"),xscript._._busy||$.LoadingOverlay("hide",!0)},t.blockUiDelay),void 0!==t.dataSelector&&null!==t.dataSelector){if(a="post",!(i=$(t.dataSelector).find(":input,[data-valmsg-for],[data-valmsg-summary]")).validateData())return void(t.blockUi&&(xscript._._busy=!1,$.LoadingOverlay("hide",!0)))}else a="get",i=$();var r=$.ajax({method:a,url:t.url,data:i.serialize(),timeout:t.requestTimeout}),o=!1;try{await r}catch(e){o=!0}if(t.processResult){var n=r.responseText,s=$(n);if(!o||r.status<400||r.status>=600){var c=n.substring(n.indexOf("<body>")+6,n.indexOf("</body>")),p=s.filter("[xmodal-open]").first(),f=$("xmodal").first();if(0!==f.length&&(c[6]||0!==p.length)){var u=f.find(".modal").first();await u.modal("hide").promise()}var d=$("body");if(c[6]){var l=$("title").first(),m=s.find("title").addBack("title")[0].outerHTML;l.replaceWith(m);var v=$("meta[name='xurl']").first(),x=v.attr("content").trim(),b=s.find("meta[name='xurl']").addBack("meta[name='xurl']")[0].outerHTML,y=$(b).attr("content").trim();v.replaceWith(b),await t.animations.positionBody.before(d),d.html(c),await t.animations.positionBody.after(d),d.removeClass("modal-open"),x!==y&&history.pushState({},$(m).text(),y),await xscript.refreshContent(d)}else{var h={};s.filter("[xtargets]").each(function(e,a){h[e]=new Promise(async function(e,i){var r=$(a),o=$(r.attr("xtargets")),n=r.attr("xposition")||t.position;switch(r.removeAttr("xtargets"),r.removeAttr("xposition"),n){case"before":await t.animations.positionBefore.before(o,r),o.before(r),await t.animations.positionBefore.after(o,r);break;case"prepend":await t.animations.positionPrepend.before(o,r),o.prepend(r),await t.animations.positionPrepend.after(o,r);break;case"append":await t.animations.positionAppend.before(o,r),o.append(r),await t.animations.positionAppend.after(o,r);break;case"after":await t.animations.positionAfter.before(o,r),o.after(r),await t.animations.positionAfter.after(o,r);break;case"replace":await t.animations.positionReplace.before(o,r),o.replaceWith(r),await t.animations.positionReplace.after(o,r);break;case"insert":await t.animations.positionInsert.before(o,r),o.html(r.html()),await t.animations.positionInsert.after(o,r);break;case"remove":await t.animations.positionRemove.before(o,r),o.remove(),await t.animations.positionRemove.after(o,r)}await xscript.refreshContent(r),e()})}),await $.when(h)}if(0!==p.length){(f=$("<xmodal>")).append(p),f.removeAttr("xmodal-open"),d.append(f),await xscript.refreshContent(f);var w=p.find(".modal").first();await w.modal("show")}}else if(n)return document.write(n),$(document).off(),history.pushState({},$("title:first()").text||"Error","/Error"),void(t.blockUi&&(xscript._._busy=!1))}t.blockUi&&(xscript._._busy=!1,$.LoadingOverlay("hide",!0))}},xscript.refreshContent=async function(e){var t=e.find("[xref]"),a=$("[xmodal-close]");$("[xtargets]").removeAttr("xtargets"),t.filter("[xprecache]").each(async function(e,t){var a=$(t);await xscript.execute({url:a.attr("xref"),dataSelector:a.attr("xdata"),blockUi:!1,timeout:0,processResult:!1})}),$("[xsrc]").each(async function(e,t){var a=$(t),i=a.attr("xttl"),r=t.hasAttribute("xprecache");if(void 0===i||null===i||r)await xscript.execute({url:a.attr("xsrc"),dataSelector:a.attr("xdata"),blockUi:!1,timeout:0,processResult:void 0===i||null===i}),a.removeAttr("xsrc"),a.removeAttr("precache");else var o=window.setInterval(async function(){document.contains(t)?await xscript.execute({url:a.attr("xsrc"),dataSelector:a.attr("xdata"),blockUi:!1,timeout:i,processResult:!r}):window.clearInterval(o)},a.attr("xttl")||0)}),t.unbind("click.xscript").on("click.xscript",async function(e){var t=$(this),a=t.attr("xref"),i=t.attr("xdata");e.preventDefault(),await xscript.execute({url:a,dataSelector:i,blockUi:!0,timeout:0,processResult:!0})}),$().add(t).add(a).each(function(e,t){var a=$(t);a[0].hasAttribute("href")||a.attr("href",a.attr("xref"))}),a.unbind("click.xscript").on("click.xscript",async function(e){e.preventDefault();var t=$("xmodal").first().find(".modal").first();await t.modal("hide").promise()}),$("xmodal").on("hidden.bs.modal",function(){$(this).remove()})};